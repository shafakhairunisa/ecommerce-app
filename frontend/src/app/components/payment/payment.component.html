<div class="payment-container">
  <h2>Checkout</h2>

  <div *ngIf="cartItems.length === 0">
    <p>Your cart is empty. Please add some products before proceeding to checkout.</p>
  </div>

  <div *ngIf="cartItems.length > 0">
    <table class="cart-table">
      <thead>
      <tr>
        <th>Product</th>
        <th>Price (RM)</th>
        <th>Quantity</th>
        <th>Total (RM)</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let item of cartItems">
        <td>{{ item.name }}</td>
        <td>{{ item.price.toFixed(2) }}</td>
        <td>{{ item.quantity }}</td>
        <td>{{ (item.price * item.quantity).toFixed(2) }}</td>
      </tr>
      </tbody>
    </table>

    <!-- Voucher selection -->
    <div class="voucher-selection" *ngIf="userVouchers.length > 0">
      <label for="voucher">Select Voucher:</label>
      <select id="voucher" [(ngModel)]="selectedVoucherId" (change)="onVoucherChange()">
        <option [ngValue]="undefined">-- No Voucher --</option>
        <option *ngFor="let v of userVouchers" [ngValue]="v.id">
          {{ v.code }} - {{ v.discountPercentage }}% OFF (Min RM {{ v.minimumPurchaseAmount }})
        </option>
      </select>
    </div>

    <!-- Summary -->
    <div class="summary">
      <p>Subtotal: <strong>RM {{ subtotal.toFixed(2) }}</strong></p>
      <p>Discount: <strong>-{{ discountPercentage }}%</strong></p>
      <p>Delivery Fee: <strong>RM {{ deliveryFee.toFixed(2) }}</strong></p>
      <hr />
      <p>Total Amount: <strong>RM {{ total.toFixed(2) }}</strong></p>
    </div>

    <button (click)="placeOrder()">Place Order</button>
  </div>
</div>
